#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Dec 15 16:11:11 2021

@author: lcabral4
"""

# citifile data parser/plotter, JWANG Nov 2021
# modified based on https://github.com/feph/citidata
# datalist contains all data np arrays

import citidata
import glob
import numpy as np
from numpy import *
import matplotlib.pyplot as plt

t = []
keyslist = []       # data name
datalist = []       # data arrays
M = N = 0

all_my_files = glob.glob("*.citi")
for filename in all_my_files:
    M += 1
#   print("=== %s ===" % filename)
    citi_file = citidata.genfromfile(filename)
    for package in citi_file.packages:
#       print(package)
#       print(package.indep)
        #print(package.deps)    # suppress screen output
        for key in package.deps:
            N += 1
            value = package.deps[key]       # get data 
#           print(value)
            keyslist.append(key)            # append key
            datalist.append(value['data'])  # append np array data
#(datalist)
name_dict = {
    0: "S11 Log Magnitude",
    1: "S21 Log Magntitude",
    2: "S12 Log Magnitude",
    3: "S22 Log magnitude",
    4: "S11 Log Magnitude",
    5: "S21 Log Magntitude",
    6: "S12 Log Magnitude",
    7: "S22 Log magnitude",
    8: "S11 Log Magnitude",
    9: "S21 Log Magntitude",
    10: "S12 Log Magnitude",
    11: "S22 Log magnitude",
    12: "S11 Log Magnitude",
    13: "S21 Log Magntitude",
    14: "S12 Log Magnitude",
    15: "S22 Log magnitude",
    16: "S11 Log Magnitude",
    17: "S21 Log Magntitude",
    18: "S12 Log Magnitude",
    19: "S22 Log magnitude"
    }
#print('\n ', M, 'files read;', N, 'datasets recorded.')
#print('dataset : name')
#plt.figure(0)
w = []
S11avg = []
x = np.linspace(8, 12, 201)
for i in range(N):
    if i == 1:
        continue
    if i == 2:
        continue
    if i ==3:
        continue
    if i == 5:
        continue
    if i == 6:
        continue
    if i == 7:
        continue
    if i == 9:
        continue
    if i == 10:
        continue
    if i == 11:
        continue
    if i == 13:
        continue
    if i == 14:
        continue
    if i == 15:
        continue
    if i == 17:
        continue
    if i == 18:
        continue
    if i == 19:
        continue
       
    fig = plt.figure(0)
#    print(i, ':', keyslist[i])
    y = datalist[i]             # data 
#    print(y)
    f = np.abs(y)
#    f = sqrt(test)
#    t.append(f)
#    w.append(f)
    mag = 20*log10(f)
    S11 = 10**mag
    S11avg.append(mag)
#    print(mag)
#    [S11, S21, S12,S22]
#    y = np.append(mag)
    plt.xlabel('Frequancy (Hz)')
    plt.ylabel('Log Magnitude (dB)')
#    plt.plot(x, mag)
    if i == 0:
        plt.plot(x, mag, label = 'Sample1')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 4:
        plt.plot(x, mag, label = 'Sample2')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 8:
        plt.plot(x, mag, label = 'Sample3')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
#    if i == 12:
#        plt.plot(x, mag, label = 'Sample4')
#        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 16:
        plt.plot(x, mag, label = 'Sample4')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    plt.title(name_dict[i])
    fig = plt.figure(11)
    SER = -10* log10(1 - np.abs(S11)**2)
#    plt.plot(x, SER)
    plt.xlabel('Frequency (Hz)')
    plt.ylabel('SER (dB)')
    plt.title('Shielding Due To Reflection')
    if i == 0:
        plt.plot(x, SER, label = 'Sample1')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 4:
        plt.plot(x, SER, label = 'Sample2')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 8:
        plt.plot(x, SER, label = 'Sample3')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 12:
        plt.plot(x, SER, label = 'Sample4')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 16:
        plt.plot(x, SER, label = 'Sample5')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
#print(S11avg)

sample1 = array([-21.60939508, -21.77495129, -21.71254085, -21.4962312 ,
       -21.05780306, -21.30891465, -21.57075679, -22.01386658,
       -22.06546807, -21.77458164, -21.87513237, -21.87986961,
       -22.1316424 , -22.14308127, -22.09558951, -21.89111105,
       -21.90789889, -21.90274539, -22.10201353, -21.95372094,
       -21.68775445, -21.39705266, -21.25237393, -21.11981727,
       -21.2962609 , -21.4453455 , -21.31756064, -21.58125895,
       -21.75547906, -22.40708882, -22.9123394 , -23.07814784,
       -23.5371169 , -23.91045784, -24.20460015, -24.11882115,
       -24.39749067, -24.37681215, -24.0924694 , -23.16465821,
       -22.86456032, -23.35815135, -23.36518952, -23.5636682 ,
       -23.34366106, -22.9823712 , -23.16224951, -23.11804513,
       -22.7537465 , -22.75189218, -22.41459657, -22.71710502,
       -23.3759884 , -23.04973887, -22.96537681, -23.30194892,
       -23.58220339, -24.22509577, -23.65437562, -22.52281243,
       -22.23516501, -21.76552275, -22.40178555, -23.19402518,
       -21.91207747, -21.04068616, -20.90018675, -21.21955567,
       -21.73543289, -21.07045907, -19.65763801, -18.5699147 ,
       -17.66816371, -17.46078722, -17.30698865, -16.26610622,
       -15.19152564, -14.72254736, -14.6991411 , -14.78978726,
       -14.29255984, -13.36944006, -13.04734356, -12.75093674,
       -12.78420032, -12.63432323, -11.74699949, -11.20484491,
       -10.86428848, -10.83689932, -10.95130504, -10.65380486,
       -10.05336872,  -9.86202428,  -9.74700736,  -9.66392171,
        -9.66936589,  -9.18702206,  -8.67660084,  -8.41491906,
        -8.41457173,  -8.65574043,  -8.68219697,  -8.31400664,
        -8.33587272,  -8.32585979,  -8.48157614,  -8.6960123 ,
        -8.60361354,  -8.52311287,  -8.37493997,  -8.28390546,
        -8.59123272,  -8.91844595,  -8.88529376,  -8.50824421,
        -8.97344957,  -9.17984092,  -9.63554653,  -9.93841484,
       -10.02936202,  -9.85223725,  -9.86650938, -10.41913407,
       -11.11637103, -11.33190907, -11.22797177, -11.25516899,
       -11.96300871, -13.03663751, -14.07970828, -14.20712905,
       -13.70750429, -13.7174427 , -14.83923624, -16.45251257,
       -18.0061129 , -17.72851515, -17.05642161, -17.71759722,
       -19.38243427, -22.88503538, -25.69649197, -23.85158578,
       -22.34556378, -21.66282266, -22.82569539, -26.32599405,
       -27.48997198, -25.952836  , -25.81982748, -25.78613373,
       -30.6462844 , -38.16472058, -40.70611309, -35.64948128,
       -29.55227209, -30.54720057, -33.80666222, -39.89704771,
       -38.62108247, -45.00194998, -35.00796044, -29.36493214,
       -26.05196484, -26.99675371, -28.44212737, -26.83576934,
       -23.54728726, -21.596045  , -23.34313008, -26.32621857,
       -25.07112421, -22.24920068, -20.71511328, -20.46021305,
       -23.30954026, -23.64563102, -21.21062137, -19.07264612,
       -17.47778362, -18.66979598, -20.7350897 , -19.84699827,
       -18.1592468 , -16.95785523, -16.47776665, -18.64875272,
       -19.31338262, -18.11292879, -16.68560367, -14.96450465,
       -15.70086903, -16.83409003, -16.29868391, -15.38658687,
       -13.99039236, -13.61904033, -15.44558367, -16.20353085,
       -15.66249359])
sample2 = array([-21.61140956, -21.7114449 , -21.69547351, -21.48752424,
       -21.04491705, -21.34193344, -21.54052409, -21.95062653,
       -22.08402605, -21.78309232, -21.88498671, -21.89396117,
       -22.09183291, -22.13940979, -22.07657035, -21.90303281,
       -21.90624431, -21.90813602, -22.08139106, -21.88844657,
       -21.58333153, -21.36481067, -21.19950678, -21.09964636,
       -21.2834194 , -21.37828058, -21.28341549, -21.59822601,
       -21.73369683, -22.38441561, -22.79941358, -23.02836781,
       -23.54360645, -23.92411317, -24.2124095 , -24.09204091,
       -24.37565157, -24.38887148, -24.12528747, -23.24618582,
       -22.87230495, -23.29136799, -23.34735716, -23.63160545,
       -23.43233283, -23.10904906, -23.16767499, -23.07308512,
       -22.73495128, -22.82345124, -22.51209146, -22.76605242,
       -23.22812827, -22.97284839, -23.0203426 , -23.37232726,
       -23.66209302, -24.11421646, -23.51086575, -22.51056257,
       -22.30465925, -21.92795731, -22.38011165, -22.95755082,
       -21.84543003, -21.13286347, -20.98994785, -21.2688963 ,
       -21.59598473, -20.94173931, -19.68786335, -18.67351387,
       -17.72567157, -17.43276547, -17.15688836, -16.22375703,
       -15.2422966 , -14.76656634, -14.69928928, -14.69091786,
       -14.19071783, -13.37651028, -13.09468411, -12.80830767,
       -12.73642906, -12.55096089, -11.71946221, -11.23899395,
       -10.9042725 , -10.86402679, -10.90105279, -10.5971215 ,
       -10.0620522 ,  -9.8987545 ,  -9.78034693,  -9.66635132,
        -9.60720597,  -9.17105778,  -8.68835412,  -8.45006351,
        -8.45176759,  -8.62947035,  -8.63689588,  -8.30336012,
        -8.34361027,  -8.36021299,  -8.49694487,  -8.64312345,
        -8.55707839,  -8.51362727,  -8.3994316 ,  -8.32911094,
        -8.56353332,  -8.84049521,  -8.83426784,  -8.90963377,
        -9.00207633,  -9.20615484,  -9.54641783,  -9.84517287,
        -9.97643906,  -9.87628412,  -9.95051055, -10.41366423,
       -11.03049998, -11.2125172 , -11.20573121, -11.3423091 ,
       -12.03631959, -12.96367508, -13.86078091, -14.01841917,
       -13.75016981, -13.87210364, -14.91652701, -16.33029341,
       -17.65915652, -17.58314248, -17.24002918, -17.968081  ,
       -19.47064814, -22.3607474 , -24.7730662 , -23.79459339,
       -22.58084952, -22.09160516, -22.95028589, -25.54035692,
       -26.78177285, -26.39977213, -26.53588879, -26.90128147,
       -31.08928219, -36.41028049, -39.3851991 , -36.14183825,
       -31.04954526, -31.7881421 , -35.25642292, -41.75243733,
       -44.04073678, -43.14574088, -35.65995279, -30.15318038,
       -27.06445716, -27.54045873, -28.11598822, -26.34461563,
       -23.70556818, -22.21213231, -23.66206631, -25.90316584,
       -24.761688  , -22.48304947, -21.19559917, -20.93048149,
       -23.07643123, -23.21668881, -21.24902437, -19.32335839,
       -17.91926472, -18.76440595, -20.28724612, -19.59941602,
       -18.28001238, -17.25669455, -16.84985608, -18.48835726,
       -18.94660422, -17.9592549 , -16.75785066, -15.39578001,
       -15.84178486, -16.54672723, -16.05858033, -15.30722453,
       -14.22182972, -14.01766615, -15.37770109, -15.89694582,
       -15.37835889])
sample3 = np.array([-21.60477821, -21.79986722, -21.73309367, -21.51058901,
       -21.07172321, -21.32245998, -21.57434737, -22.01169635,
       -22.07478115, -21.7476477 , -21.87828277, -21.84904886,
       -22.14014099, -22.13256375, -22.06987837, -21.90783077,
       -21.86655602, -21.93129351, -22.12193583, -21.94196644,
       -21.66316462, -21.40503636, -21.22820063, -21.1476311 ,
       -21.36070766, -21.45047144, -21.30155112, -21.59083244,
       -21.70911708, -22.43615713, -22.92567736, -23.04030897,
       -23.52489403, -23.87693474, -24.18535806, -24.14183713,
       -24.38084395, -24.41445245, -24.04417319, -23.1603117 ,
       -22.87490595, -23.33561165, -23.35387407, -23.57078067,
       -23.33497336, -23.00037126, -23.19427691, -23.11312478,
       -22.71442775, -22.74692342, -22.390754  , -22.77069667,
       -23.37969367, -23.04423162, -22.95868944, -23.28770375,
       -23.61803973, -24.21222228, -23.68639638, -22.51940857,
       -22.23112714, -21.76194976, -22.39542997, -23.22540675,
       -21.93911944, -21.02447775, -20.8671852 , -21.20030566,
       -21.74132037, -21.09879725, -19.64276582, -18.54146044,
       -17.63917517, -17.48285604, -17.34158731, -16.26206368,
       -15.19470877, -14.70265435, -14.69509408, -14.80408659,
       -14.30023287, -13.37093423, -13.04811586, -12.75844818,
       -12.7833762 , -12.66380635, -11.74369084, -11.20111586,
       -10.85750418, -10.8159681 , -10.95661254, -10.65496339,
       -10.03698915,  -9.85779509,  -9.73901394,  -9.66149353,
        -9.67278626,  -9.19081168,  -8.66266284,  -8.41755696,
        -8.40417278,  -8.6535166 ,  -8.6917979 ,  -8.31391857,
        -8.32979147,  -8.31927048,  -8.47115552,  -8.70616576,
        -8.60448146,  -8.51727736,  -8.37317137,  -8.29972397,
        -8.5914317 ,  -8.93120148,  -8.89526755,  -8.91445455,
        -8.96043678,  -9.17714028,  -9.615371  ,  -9.96117765,
       -10.02290727,  -9.843306  ,  -9.85628254, -10.43277915,
       -11.11763655, -11.33190907, -11.23481405, -11.24597513,
       -11.97081817, -13.04436743, -14.09467112, -14.22404668,
       -13.70099321, -13.71455155, -14.8230357 , -16.47736598,
       -18.03361486, -17.74596947, -17.01721995, -17.71443801,
       -19.36751756, -22.93104447, -25.80414185, -23.87728947,
       -22.3096458 , -21.63835398, -22.80439567, -26.38747368,
       -27.60146175, -25.90225046, -25.66894675, -25.69960866,
       -30.67576409, -38.21051812, -40.70043794, -35.61096949,
       -29.33852771, -30.44726207, -33.68394864, -39.94740657,
       -38.17210848, -44.96370328, -34.61398615, -29.32511083,
       -25.98260862, -26.90967721, -28.52370638, -26.96538356,
       -23.52273847, -21.55316773, -23.31999569, -26.37691376,
       -25.17752308, -22.19561626, -20.69276383, -20.41532903,
       -23.316479  , -23.6762415 , -21.19155157, -19.05814302,
       -17.42573632, -18.65980614, -20.72136283, -19.87803706,
       -18.1468755 , -16.90214675, -16.45135204, -18.6340494 ,
       -19.34303125, -18.13753836, -16.66566475, -14.9323582 ,
       -15.67993126, -16.82360377, -16.3388446 , -15.38576111,
       -13.95599587, -13.60217175, -15.47264491, -16.20748569,
       -15.69374095])
'''
sample4 = np.array([-21.85514923, -21.90685087, -21.83702587, -21.700175  ,
       -21.28424575, -21.53040113, -21.59229997, -21.84747537,
       -21.89586563, -21.58223208, -21.71656511, -21.70101664,
       -21.83531326, -21.80806755, -21.75586845, -21.67179484,
       -21.81883524, -21.80681158, -21.87709207, -21.72328648,
       -21.47935495, -21.48099213, -21.43621418, -21.31620012,
       -21.41744064, -21.50284113, -21.49195487, -21.86527251,
       -21.91259718, -22.379184  , -22.58704923, -22.64334922,
       -23.18830132, -23.43909641, -23.68307588, -23.43349895,
       -23.62352234, -23.90011047, -23.8635494 , -23.11646316,
       -22.71312498, -22.92751471, -23.04209544, -23.41621514,
       -23.34645123, -23.11744973, -22.99833927, -22.90059003,
       -22.82933507, -23.01659485, -22.82166261, -22.98374241,
       -23.21983912, -22.97333728, -23.1698046 , -23.48113149,
       -23.80366342, -23.94082286, -23.35670134, -22.62676973,
       -22.57641114, -22.28995306, -22.6108246 , -22.83664099,
       -21.91858559, -21.3518222 , -21.12721248, -21.31339942,
       -21.33065158, -20.69510138, -19.75888755, -18.88487273,
       -18.02254127, -17.65330774, -17.30044075, -16.47091137,
       -15.64579981, -15.14479696, -14.96264909, -14.79322104,
       -14.26008337, -13.54506056, -13.286707  , -12.96439905,
       -12.77594894, -12.48288298, -11.77869159, -11.38087169,
       -11.03103316, -10.94798521, -10.84631904, -10.52158647,
       -10.05850135,  -9.91610019,  -9.82416832,  -9.65135461,
        -9.54226183,  -9.16388567,  -8.76226997,  -8.53322879,
        -8.54638134,  -8.65356251,  -8.6209034 ,  -8.31639511,
        -8.34933091,  -8.38720606,  -8.48168877,  -8.53858045,
        -8.46166658,  -8.48007138,  -8.40992676,  -8.37716699,
        -8.51258758,  -8.70934998,  -8.75237515,  -8.87263503,
        -9.01918875,  -9.15401747,  -9.39550792,  -9.66958356,
        -9.87902668,  -9.9256987 , -10.07800324, -10.45140691,
       -10.91287653, -11.14941879, -11.26582613, -11.54666259,
       -12.25031801, -13.00647525, -13.70340798, -13.94812743,
       -13.97454264, -14.28208375, -15.24202381, -16.44192786,
       -17.46218673, -17.62682965, -17.72196141, -18.42820619,
       -19.75315514, -22.00003062, -23.91203831, -23.8724855 ,
       -23.16987748, -22.92594167, -23.56894162, -25.19276263,
       -26.39688405, -27.04858208, -27.76814684, -28.35634032,
       -30.80807485, -33.4344449 , -35.71644221, -20.56552667,
       -20.05772979, -33.92477181, -36.87816108, -41.14450776,
       -43.07009107, -37.38949962, -33.48220566, -30.89706306,
       -29.16977691, -29.07440452, -28.28776603, -26.11575984,
       -24.10053429, -23.22030572, -24.2566371 , -25.49619678,
       -24.39630245, -22.66205118, -21.65688269, -21.46407443,
       -22.7790072 , -22.66875865, -21.14208637, -19.5659138 ,
       -18.4968605 , -18.92746323, -19.92801837, -19.40957893,
       -18.42773307, -17.59611888, -17.21822873, -18.05905545,
       -18.29689472, -17.64450904, -16.82599731, -15.97528444,
       -16.09388214, -16.4043769 , -15.99839556, -15.47194643,
       -14.74464934, -14.70276904, -15.49346948, -15.57402596,
       -15.20339964])
'''

sample5 = np.array([-21.60233586, -21.794523  , -21.74271827, -21.49938669,
       -21.08834647, -21.3282523 , -21.60949535, -22.02544893,
       -22.03769449, -21.73868196, -21.86105451, -21.87375593,
       -22.1309678 , -22.13182802, -22.06072779, -21.87655223,
       -21.88333028, -21.91838877, -22.08922372, -21.94993525,
       -21.66456877, -21.4110611 , -21.25646323, -21.12212486,
       -21.33286989, -21.48010038, -21.32858349, -21.60904923,
       -21.73746194, -22.45246436, -22.8905447 , -23.06752353,
       -23.51549362, -23.85165217, -24.16464511, -24.11351683,
       -24.37593883, -24.33836495, -24.09352212, -23.17163917,
       -22.87726429, -23.34872053, -23.34280575, -23.578073  ,
       -23.32493618, -22.99487089, -23.18300844, -23.10298723,
       -22.70896377, -22.77514381, -22.34958517, -22.72975881,
       -23.40107236, -23.01704163, -22.93572488, -23.21120049,
       -23.56765607, -24.19976138, -23.63392933, -22.49170195,
       -22.20025765, -21.76662317, -22.40340351, -23.18782113,
       -21.92132053, -21.03414485, -20.86517473, -21.20011848,
       -21.73745499, -21.09076393, -19.65833638, -18.52978089,
       -17.63019873, -17.45402658, -17.33558923, -16.26772095,
       -15.178125  , -14.72836461, -14.67334113, -14.79752606,
       -14.30252295, -13.36436451, -13.04450438, -12.7554945 ,
       -12.79293078, -12.67038842, -11.74962471, -11.1933338 ,
       -10.85340211, -10.81527411, -10.95540289, -10.65198519,
       -10.03552049,  -9.84360721,  -9.73842931,  -9.65875171,
        -9.67695955,  -9.1916857 ,  -8.66568074,  -8.41318132,
        -8.40888322,  -8.65245347,  -8.68892598,  -8.30814491,
        -8.32574711,  -8.31693104,  -8.47439653,  -8.70188735,
        -8.61092745,  -8.51218729,  -8.37024974,  -8.28986051,
        -8.58154392,  -8.93493907,  -8.89146223,  -8.91703705,
        -8.95411703,  -9.1840023 ,  -9.63872353,  -9.95834744,
       -10.03584666,  -9.84681761,  -9.86661018, -10.43712435,
       -11.1331427 , -11.36307742, -11.22566188, -11.24367966,
       -11.95658158, -13.02970982, -14.1071538 , -14.23662614,
       -13.69709078, -13.70322282, -14.81842907, -16.47874356,
       -18.06803773, -17.74823656, -17.03158392, -17.71028303,
       -19.34807822, -22.97528125, -25.83365928, -23.87119419,
       -22.29223229, -21.59055039, -22.79926131, -26.49597604,
       -27.70702419, -25.83874864, -25.60441121, -25.59712196,
       -30.70385345, -38.51419407, -40.65725763, -35.37446293,
       -29.32791387, -30.43345557, -33.70719126, -39.59944355,
       -37.84384555, -44.70482065, -34.61895901, -29.30616207,
       -25.9127053 , -26.93243604, -28.52298429, -26.96840751,
       -23.53708153, -21.54916617, -23.32608402, -26.38581504,
       -25.13125826, -22.19601118, -20.65615946, -20.38703665,
       -23.31719089, -23.69643902, -21.19100749, -19.04564539,
       -17.39252816, -18.65468764, -20.73250238, -19.87689689,
       -18.14238532, -16.88180742, -16.4129243 , -18.67173826,
       -19.33866156, -18.15249234, -16.65877767, -14.90014892,
       -15.63690534, -16.82170409, -16.34361751, -15.3836997 ,
       -13.92854152, -13.56360933, -15.44017008, -16.24084528,
       -15.71208233])

plt.figure(1456)
test = []
for i,j,k,m in zip(sample1, sample2, sample3, sample5):
    f = (i+j+k+m)/4
    test.append(f)
#print(test)
plt.title('S11 Log Mag Average')
plt.xlabel('frequency (Hz)')
plt.ylabel('Log Magnitude (dB)')
plt.plot(x, test)   
#print(test)
'''----------------------------------------------------------'''
S21avg = []
for i in range(N):
    if i == 0:
        continue
    if i == 2:
        continue
    if i ==3:
        continue
    if i == 4:
        continue
    if i == 6:
        continue
    if i == 7:
        continue
    if i == 8:
        continue
    if i == 10:
        continue
    if i == 11:
        continue
    if i == 12:
        continue
    if i == 13:
        continue
    if i == 14:
        continue
    if i == 15:
        continue
    if i == 16:
        continue
    if i == 18:
        continue
    if i == 19:
        continue
    
    
    fig = plt.figure(1)
#    print(i, ':', keyslist[i])
    y = datalist[i]             # data 
#    print(y)
    f = np.abs(y)
#    f = sqrt(test)
    mag = 20*log10(f)
    S21avg.append(mag)
#    print(mag)
#    [S11, S21, S12,S22]
#    y = np.append(mag)
    plt.xlabel('Frequancy (Hz)')
    plt.ylabel('Log Magnitude (dB)')
#    plt.plot(x, mag)
    plt.title(name_dict[i])
    if i == 1:
        plt.plot(x, mag, label = 'Sample1')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 5:
        plt.plot(x, mag, label = 'Sample2')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 9:
        plt.plot(x, mag, label = 'Sample3')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
#    if i == 13:
#        plt.plot(x, mag, label = 'Sample4')
#        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 17:
        plt.plot(x, mag, label = 'Sample4')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
#print(S21avg)
sample1 = np.array([-0.04313002,  0.0125877 , -0.04751995, -0.02755099, -0.0069632 ,
       -0.00505852,  0.12638081,  0.1335415 ,  0.05710222,  0.06563217,
        0.00829473,  0.07356234,  0.13898057, -0.01050882, -0.0275188 ,
       -0.03496356, -0.05008423,  0.08395402,  0.02209159, -0.07618162,
       -0.07430568, -0.17593685, -0.10354545, -0.05005964, -0.15406346,
       -0.10799979, -0.13812218, -0.14272915,  0.04169374,  0.0405946 ,
        0.00716032,  0.00785568, -0.07728514, -0.03945198, -0.03874192,
       -0.12522829, -0.15600443, -0.23281076, -0.21182157, -0.1256624 ,
       -0.18657799, -0.16051154, -0.16733126, -0.20367178, -0.0963961 ,
       -0.14289271, -0.18820024, -0.16546815, -0.26770918, -0.23757682,
       -0.10234983, -0.10584853, -0.04576711, -0.04948223, -0.12119925,
       -0.04559288, -0.06214316, -0.08042464, -0.08708201, -0.23803192,
       -0.20402287, -0.11105067, -0.1054248 ,  0.03354291,  0.01712886,
       -0.11550594,  0.0076244 ,  0.00318515, -0.0285313 , -0.03810927,
       -0.27796837, -0.30215003, -0.25089859, -0.3130759 , -0.16182316,
       -0.14857896, -0.21226228,  0.01154575, -0.03918628, -0.03539784,
        0.17216452,  0.0089509 , -0.07648526, -0.2256936 , -0.5030878 ,
       -0.25022008, -0.26698495, -0.52747083, -0.304564  , -0.39693508,
       -0.29075689,  0.03431967, -0.3286764 , -0.56538736, -0.66199033,
       -0.93302322, -0.76348992, -0.91363323, -1.03645777, -0.65855182,
       -0.60981017, -0.44615669, -0.16340314, -0.29882133, -0.20039401,
       -0.2939349 , -0.76162261, -0.74306279, -0.83656286, -0.91833738,
       -0.91451743, -1.11349098, -0.88969387, -0.6436913 , -0.63174148,
       -0.58805091, -0.78493011, -0.82636757, -0.79520641, -0.93914851,
       -0.80427867, -0.72438501, -0.72328837, -0.53724864, -0.53228325,
       -0.3854413 , -0.19871138, -0.17286659, -0.18670053, -0.31668513,
       -0.31386263, -0.12006977, -0.1451757 , -0.10680052, -0.08674371,
       -0.1565731 ,  0.0058068 , -0.02191624, -0.11765555, -0.13855465,
       -0.23119146, -0.20545785, -0.1577921 , -0.20532848, -0.14979526,
       -0.17109695, -0.18954424, -0.05568174, -0.11859935, -0.15159122,
       -0.24909605, -0.30577557, -0.27042815, -0.26884833, -0.26094393,
       -0.30695351, -0.3065177 , -0.25848589, -0.28194118, -0.27808771,
       -0.2932784 , -0.30328271, -0.1385645 , -0.14801779, -0.07157837,
       -0.0189179 , -0.09658511,  0.04291011, -0.0071988 , -0.05858715,
       -0.10231441, -0.28146182, -0.23071666, -0.0719272 , -0.08162511,
       -0.00822969, -0.1635994 , -0.20455224,  0.0374231 , -0.05398744,
       -0.08310679, -0.1815926 , -0.37334762, -0.255854  , -0.17485893,
       -0.16845345, -0.08198743, -0.23091189, -0.1975064 , -0.11088948,
       -0.18266107, -0.17954637, -0.28119191, -0.32086284, -0.27643211,
       -0.31432946, -0.29942354, -0.28348767, -0.30497638, -0.19901178,
       -0.18847304]) 
sample2 = np.array([-3.24510507e-02,  1.66090713e-02, -4.60877639e-02, -2.11779479e-02,
       -3.79754968e-04,  3.49962532e-03,  1.32445499e-01,  1.41292093e-01,
        6.38321431e-02,  7.43808741e-02,  1.01242745e-02,  8.56816463e-02,
        1.47180718e-01, -1.37108179e-03, -2.54449054e-02, -2.56808280e-02,
       -4.12603197e-02,  8.66297161e-02,  2.57894531e-02, -7.20317966e-02,
       -6.84367998e-02, -1.69201796e-01, -9.83602128e-02, -3.87780164e-02,
       -1.51439202e-01, -9.98006079e-02, -1.28267388e-01, -1.35448226e-01,
        4.87122182e-02,  4.56012196e-02,  1.45919871e-02,  1.51550682e-02,
       -6.81132927e-02, -3.36058504e-02, -2.65793182e-02, -1.15041381e-01,
       -1.49997503e-01, -2.28309047e-01, -2.06422409e-01, -1.21927773e-01,
       -1.77010854e-01, -1.59693483e-01, -1.60500232e-01, -1.94527167e-01,
       -8.96532435e-02, -1.32903264e-01, -1.83754877e-01, -1.60277090e-01,
       -2.60419729e-01, -2.28224957e-01, -9.68642482e-02, -1.03688955e-01,
       -4.18088936e-02, -4.97138841e-02, -1.15351730e-01, -4.07019329e-02,
       -5.65035363e-02, -6.51213309e-02, -7.88688806e-02, -2.36413970e-01,
       -1.96938445e-01, -1.04240355e-01, -9.40582642e-02,  3.84114968e-02,
        2.11474777e-02, -1.08349077e-01,  1.07946228e-02,  4.49810424e-03,
       -2.32055120e-02, -3.24525315e-02, -2.73364940e-01, -2.96131135e-01,
       -2.40849790e-01, -3.13353196e-01, -1.63905944e-01, -1.44752282e-01,
       -2.07017388e-01,  1.13302338e-02, -2.70427397e-02, -3.38583695e-02,
        1.76626658e-01,  1.55501655e-02, -7.65849705e-02, -2.18501770e-01,
       -5.01755585e-01, -2.51291328e-01, -2.66889596e-01, -5.16281636e-01,
       -2.89592894e-01, -3.82463114e-01, -2.83584994e-01,  3.85579039e-02,
       -3.19599594e-01, -5.56228775e-01, -6.41184660e-01, -9.28645337e-01,
       -7.60611428e-01, -9.05433680e-01, -1.03151837e+00, -6.45693052e-01,
       -6.00550027e-01, -4.48662750e-01, -1.53407730e-01, -2.97516935e-01,
       -1.88348462e-01, -2.76013431e-01, -7.56130073e-01, -7.38256261e-01,
       -8.30910242e-01, -9.18217137e-01, -8.98671767e-01, -1.10634295e+00,
       -8.90147151e-01, -6.29091374e-01, -6.34207007e-01, -5.78066603e-01,
       -7.65332670e-01, -8.39767015e-01, -7.85761348e-01, -9.33374869e-01,
       -8.05454422e-01, -7.08245491e-01, -7.20180189e-01, -5.43232161e-01,
       -5.16793106e-01, -3.95141112e-01, -1.94693023e-01, -1.65539318e-01,
       -1.87243836e-01, -3.05034877e-01, -3.05894194e-01, -1.24292542e-01,
       -1.40172816e-01, -1.07722930e-01, -8.61609214e-02, -1.47373070e-01,
        3.04584038e-03, -1.46453716e-02, -1.19445493e-01, -1.33509806e-01,
       -2.18994337e-01, -1.99238750e-01, -1.62539571e-01, -2.04064114e-01,
       -1.50196140e-01, -1.71080225e-01, -1.73543860e-01, -4.93263752e-02,
       -1.14837045e-01, -1.47692343e-01, -2.39186930e-01, -2.97270380e-01,
       -2.64814279e-01, -2.64047807e-01, -2.67162649e-01, -2.97881570e-01,
       -2.97321121e-01, -2.47907111e-01, -2.83195744e-01, -2.77650122e-01,
       -2.93963993e-01, -2.89671733e-01, -1.39779055e-01, -1.38867904e-01,
       -6.54450502e-02, -2.09979892e-02, -8.32624854e-02,  4.66032392e-02,
       -2.74652231e-03, -6.12213782e-02, -9.99640716e-02, -2.81060340e-01,
       -2.26013815e-01, -6.81226482e-02, -7.84704290e-02, -1.13848479e-02,
       -1.61484682e-01, -2.03116174e-01,  4.61395962e-02, -4.54106801e-02,
       -7.88497524e-02, -1.76750539e-01, -3.74489440e-01, -2.51210220e-01,
       -1.64332774e-01, -1.73481537e-01, -7.92893752e-02, -2.14852854e-01,
       -1.97057049e-01, -1.10708562e-01, -1.82153177e-01, -1.72077742e-01,
       -2.58393137e-01, -3.22654163e-01, -2.80585977e-01, -3.13682025e-01,
       -2.86174254e-01, -2.66551803e-01, -2.97150184e-01, -2.09998322e-01,
       -2.02702335e-01]) 
sample3 = np.array([-0.04744798,  0.01193155, -0.0503784 , -0.02802223, -0.00476168,
       -0.00272128,  0.12768963,  0.13344702,  0.05574068,  0.06828409,
        0.00774841,  0.07832231,  0.14059737, -0.00736252, -0.03001013,
       -0.03295678, -0.05027718,  0.08066788,  0.02467895, -0.07456285,
       -0.07367415, -0.17611221, -0.09876787, -0.04790686, -0.1510219 ,
       -0.10322053, -0.13352712, -0.13965134,  0.04443562,  0.04278467,
        0.01105838,  0.01381922, -0.07206436, -0.03779117, -0.03222457,
       -0.12125372, -0.14931827, -0.23122949, -0.20961346, -0.12818342,
       -0.18120636, -0.16045299, -0.16705015, -0.20278929, -0.09395843,
       -0.14132064, -0.18365868, -0.16032268, -0.26509044, -0.22746661,
       -0.09801074, -0.10623409, -0.04309938, -0.0495395 , -0.12392909,
       -0.04372139, -0.06574941, -0.07136232, -0.08078602, -0.23518014,
       -0.20004464, -0.10795513, -0.09240529,  0.03858332,  0.01929218,
       -0.11407982,  0.00424719,  0.00196943, -0.02265933, -0.04085918,
       -0.27565784, -0.30277546, -0.24971863, -0.31214453, -0.16263081,
       -0.14708578, -0.21179083,  0.00773172, -0.03514319, -0.03347238,
        0.17942755,  0.00890681, -0.07757966, -0.22650273, -0.50184322,
       -0.2449194 , -0.26645271, -0.5236702 , -0.29834155, -0.39687179,
       -0.28173496,  0.0381601 , -0.32980039, -0.56002563, -0.65926519,
       -0.93177382, -0.75999349, -0.9034983 , -1.03735522, -0.65226495,
       -0.6033773 , -0.43875443, -0.16060921, -0.29452472, -0.19595938,
       -0.29498643, -0.75642666, -0.74206382, -0.83964481, -0.91606168,
       -0.9115073 , -1.11983208, -0.88947842, -0.63877919, -0.63131205,
       -0.58400422, -0.78307068, -0.83225967, -0.7899986 , -0.93378183,
       -0.79958414, -0.71725895, -0.72102495, -0.53727692, -0.52835766,
       -0.3828334 , -0.19634122, -0.1701781 , -0.18092669, -0.31422797,
       -0.30835794, -0.11643739, -0.1454473 , -0.09541223, -0.08070142,
       -0.15176098,  0.00883837, -0.01418347, -0.11855991, -0.13353272,
       -0.2218562 , -0.20095   , -0.15450904, -0.19768721, -0.15118564,
       -0.17354613, -0.18744832, -0.05323147, -0.11928343, -0.14700238,
       -0.24915715, -0.30132771, -0.26485638, -0.25863807, -0.25922106,
       -0.2995739 , -0.30684144, -0.25302904, -0.27772375, -0.27884123,
       -0.28924505, -0.3018648 , -0.14186691, -0.14392593, -0.06936157,
       -0.0156952 , -0.0918725 ,  0.04835686, -0.00902746, -0.05893334,
       -0.09882246, -0.28275351, -0.231277  , -0.06977267, -0.07768925,
       -0.00223631, -0.15967658, -0.20305671,  0.04577973, -0.04186339,
       -0.07330245, -0.17633441, -0.36925489, -0.25486832, -0.17056736,
       -0.1646892 , -0.07794327, -0.22048248, -0.19532587, -0.09786543,
       -0.18083322, -0.17878245, -0.27411384, -0.32110849, -0.27247135,
       -0.31192803, -0.28242072, -0.27457729, -0.30188063, -0.19442234,
       -0.18938288]) 
sample4 = np.array([-0.04563718,  0.01279667, -0.05385089, -0.02625699, -0.00586691,
        0.00151097,  0.12416378,  0.13264744,  0.05931759,  0.06633723,
        0.01112045,  0.07738638,  0.1403994 , -0.00238625, -0.024902  ,
       -0.03012131, -0.05045926,  0.08149861,  0.02493564, -0.07359589,
       -0.07045712, -0.1737417 , -0.09938552, -0.04412984, -0.15413373,
       -0.10650869, -0.1372995 , -0.14101185,  0.04642656,  0.0432819 ,
        0.01247106,  0.01336028, -0.07158835, -0.03267841, -0.02920724,
       -0.11915865, -0.14869504, -0.22372331, -0.20946426, -0.12536447,
       -0.18194125, -0.15897025, -0.16612183, -0.20455607, -0.09584852,
       -0.1368319 , -0.18354916, -0.16106817, -0.26665653, -0.227402  ,
       -0.09934225, -0.10479686, -0.04402879, -0.0514743 , -0.1205401 ,
       -0.0443145 , -0.06233939, -0.07582336, -0.08811467, -0.23390625,
       -0.20301487, -0.10489488, -0.09890685,  0.03993444,  0.02474064,
       -0.10765169,  0.00951162,  0.00248122, -0.02469305, -0.03520396,
       -0.27480035, -0.30047554, -0.24646816, -0.30938124, -0.15781483,
       -0.15042963, -0.21055291,  0.00735831, -0.03024109, -0.02887145,
        0.17302748,  0.01495886, -0.0740971 , -0.22349597, -0.50013943,
       -0.24356723, -0.26854758, -0.52016469, -0.29945925, -0.3892547 ,
       -0.28538649,  0.03389811, -0.32333522, -0.55431227, -0.66116754,
       -0.92730652, -0.75333299, -0.90639023, -1.03431319, -0.65617294,
       -0.60827122, -0.44058743, -0.15792789, -0.2941695 , -0.19923297,
       -0.29442732, -0.75888608, -0.74527599, -0.83671829, -0.91576343,
       -0.91124527, -1.11857616, -0.88097958, -0.63743717, -0.63069599,
       -0.58130609, -0.77730114, -0.83021588, -0.79021561, -0.93160419,
       -0.79822527, -0.72130184, -0.72242409, -0.53290132, -0.52545351,
       -0.37743172, -0.19332554, -0.16933541, -0.17939736, -0.3118248 ,
       -0.30562625, -0.11362349, -0.14382343, -0.09912769, -0.08287549,
       -0.15289439,  0.01189172, -0.0113322 , -0.11306634, -0.1337867 ,
       -0.2271912 , -0.19673808, -0.1539886 , -0.20188441, -0.14581027,
       -0.17202043, -0.18242584, -0.04409491, -0.1167158 , -0.14663319,
       -0.2471471 , -0.3036394 , -0.26806595, -0.2630868 , -0.26086166,
       -0.30176776, -0.30521228, -0.25697561, -0.27872583, -0.28021348,
       -0.28629424, -0.30086929, -0.13454742, -0.14369077, -0.06759156,
       -0.01397791, -0.0889297 ,  0.04683819, -0.00411677, -0.05279217,
       -0.09196106, -0.27767259, -0.2248056 , -0.06947803, -0.07759366,
       -0.00361873, -0.1586471 , -0.20479597,  0.04584708, -0.04670861,
       -0.06616041, -0.1746212 , -0.36590085, -0.24922183, -0.16548038,
       -0.1585857 , -0.07727325, -0.2226706 , -0.19068515, -0.09931347,
       -0.18345004, -0.17669834, -0.27884543, -0.31426031, -0.27363132,
       -0.31214106, -0.2849546 , -0.27701378, -0.30563652, -0.19430651,
       -0.1846975 ])
plt.figure(1457)
test = []
for i,j,k,m in zip(sample1, sample2, sample3, sample4):
    f = (i+j+k+m)/4
    test.append(f)
#print(test)
plt.title('S21 Log Mag Average')
plt.xlabel('frequency (Hz)')
plt.ylabel('Log Magnitude (dB)')
plt.plot(x, test)  
#print(test)

S2 = []   
S12avg = [] 
for i in range(N):
    if i == 0:
        continue
    if i == 1:
        continue
    if i ==3:
        continue
    if i == 4:
        continue
    if i == 5:
        continue
    if i == 7:
        continue
    if i == 8:
        continue
    if i == 9:
        continue
    if i == 11:
        continue
    if i == 12:
        continue
    if i == 13:
        continue
    if i == 14:
        continue
    if i == 15:
        continue
    if i == 16:
        continue
    if i == 17:
        continue
    if i == 19:
        continue
    
    
    fig = plt.figure(2)
#    print(i, ':', keyslist[i])
    y = datalist[i]             # data 
#    print(y)
    f = np.abs(y)
#    f = sqrt(test)
    mag = 20*log10(f)
    S12 = 10**mag
    S2.append(S12)
    S12avg.append(mag)
    Total_SE = -10*log10(np.abs(S12)**2)
#    print(mag)
#    [S11, S21, S12,S22]
#    y = np.append(mag)
    plt.xlabel('Frequancy (Hz)')
    plt.ylabel('Log Magnitude (dB)')
#    plt.plot(x, mag)
    if i == 2:
        plt.plot(x, mag, label = 'Sample1')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 6:
        plt.plot(x, mag, label = 'Sample2')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 10:
        plt.plot(x, mag, label = 'Sample3')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
#    if i == 14:
#        plt.plot(x, mag, label = 'Sample4')
#        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 18:
        plt.plot(x, mag, label = 'Sample5')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    plt.title(name_dict[i])
    fig = plt.figure(9)
    plt.title('Total SE')
    plt.xlabel('Frequency (Hz)')
    plt.ylabel('Total SE (dB)')
#    plt.legend((Total_SE[i]),loc='center left')
        
    if i == 2:
        plt.plot(x, Total_SE, label = 'Sample1')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 6:
        plt.plot(x, Total_SE, label = 'Sample2')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 10:
        plt.plot(x, Total_SE, label = 'Sample3')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 14:
        plt.plot(x, Total_SE, label = 'Sample4')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 18:
        plt.plot(x, Total_SE, label = 'Sample5')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))

#print(S12avg)

sample1 = np.array([-0.01486415,  0.03175961, -0.0787312 , -0.06054402,  0.09579356,
        0.02828479,  0.0621753 ,  0.01127947, -0.03626711,  0.11981975,
        0.09688101,  0.04181148,  0.00392186, -0.11179639,  0.01372595,
        0.04138133, -0.03788221, -0.0252669 , -0.19378125, -0.15153078,
        0.02370461, -0.04050737,  0.00710375, -0.05576088, -0.14759082,
        0.04110605,  0.04207231,  0.03187946, -0.01105593, -0.14152349,
       -0.02176361,  0.04524496,  0.02461332,  0.02412708, -0.12264406,
       -0.10925327,  0.02123273,  0.01331507,  0.02329041, -0.09060723,
       -0.19887673, -0.04512943,  0.0140101 ,  0.02403914, -0.01781189,
       -0.16591266, -0.1133923 , -0.02429803, -0.01444011, -0.0060241 ,
       -0.15810722, -0.19210514, -0.06156509, -0.04157979,  0.00967614,
       -0.07497542, -0.15339169, -0.08849352, -0.05042105,  0.01770064,
        0.00942749, -0.16027461, -0.10147773, -0.0434451 ,  0.03792961,
        0.08892639, -0.1176025 , -0.14320092, -0.02265145,  0.00840241,
        0.07675566, -0.10026421, -0.32389131, -0.14657979, -0.07444711,
        0.00680597, -0.00694684, -0.38416635, -0.28920805, -0.0955223 ,
        0.022616  ,  0.10589334, -0.34989159, -0.41917003, -0.1901121 ,
       -0.20893461,  0.14519467,  0.02413949, -0.60873125, -0.56387103,
       -0.54376277, -0.34930494, -0.16046909, -0.72808457, -1.00959681,
       -1.00258378, -0.86190673, -0.31803364, -0.70540672, -1.30929972,
       -1.20288653, -1.16931569, -0.72046696, -0.5891768 , -1.11281515,
       -1.07635575, -1.15004526, -1.04348241, -0.47862372, -0.71204166,
       -1.05218339, -1.09072883, -1.09043356, -0.54109536, -0.30592273,
       -0.57843134, -0.71364251, -0.8129011 , -0.52329554, -0.05827461,
       -0.1853966 , -0.41219971, -0.59035277, -0.5855719 , -0.16228533,
       -0.04589927, -0.2404939 , -0.39165809, -0.50107673, -0.1843509 ,
        0.10588956, -0.00799477, -0.19307005, -0.32475276, -0.22830777,
       -0.00718835, -0.04172991, -0.11251586, -0.26144231, -0.27943927,
       -0.15019433, -0.10325311, -0.12799347, -0.18615205, -0.25785177,
       -0.24743917, -0.19559679, -0.20635278, -0.24544395, -0.34871841,
       -0.31526522, -0.30822437, -0.29477447, -0.29077117, -0.32711063,
       -0.30932132, -0.31316948, -0.30424298, -0.29045622, -0.27665113,
       -0.24580131, -0.22365302, -0.25594741, -0.26381661, -0.25007148,
       -0.20137501, -0.17219787, -0.19524483, -0.25266612, -0.35829081,
       -0.28827186, -0.17367838, -0.18006431, -0.22368629, -0.32332699,
       -0.35146282, -0.1913925 , -0.1375005 , -0.16128573, -0.21528836,
       -0.32987832, -0.19209949, -0.13074276, -0.13886391, -0.11516704,
       -0.18277629, -0.17119178, -0.09448567, -0.11919863, -0.06025273,
       -0.0630476 , -0.09423609, -0.02085797, -0.07728579, -0.11547536,
       -0.05605629, -0.01520683,  0.04194108, -0.00854823, -0.1024893 ,
       -0.13913135]) 
sample2 = np.array([-0.00224448,  0.03840922, -0.0739078 , -0.05261672,  0.10666824,
        0.03700836,  0.07719993,  0.02587031, -0.02957986,  0.12863972,
        0.103002  ,  0.05442204,  0.01756111, -0.1033934 ,  0.02201842,
        0.05164499, -0.02474168, -0.01728069, -0.18293668, -0.14193979,
        0.0324562 , -0.02422915,  0.02020653, -0.04724239, -0.1369249 ,
        0.06057716,  0.04626854,  0.04039941,  0.00147926, -0.13183194,
       -0.00384025,  0.05630601,  0.03915685,  0.04313995, -0.10766638,
       -0.0954072 ,  0.0301021 ,  0.01777882,  0.02817237, -0.07681934,
       -0.18433114, -0.03747947,  0.0229862 ,  0.03621958, -0.01131013,
       -0.15461903, -0.09987812, -0.01744737, -0.00559702,  0.00449792,
       -0.1487601 , -0.1771118 , -0.05919452, -0.03053009,  0.02170824,
       -0.06757023, -0.1420683 , -0.08277588, -0.03837433,  0.02369314,
        0.01589588, -0.14714162, -0.09143761, -0.02889442,  0.04968631,
        0.09654651, -0.10577223, -0.13265559, -0.00880595,  0.02197099,
        0.09134031, -0.08021738, -0.31462044, -0.14168127, -0.06453708,
        0.0141808 ,  0.00642471, -0.37083152, -0.27640573, -0.07979172,
        0.03613381,  0.11740567, -0.33614056, -0.41325491, -0.17353399,
       -0.19835667,  0.1530954 ,  0.03285386, -0.60102835, -0.55885201,
       -0.53738727, -0.33482192, -0.15026761, -0.71008392, -0.9921145 ,
       -0.99070108, -0.84594197, -0.31520936, -0.69110252, -1.29191913,
       -1.19416123, -1.15653218, -0.70898748, -0.58280432, -1.09863594,
       -1.0671682 , -1.13629116, -1.03336248, -0.48250354, -0.70305833,
       -1.0398125 , -1.0768333 , -1.07806102, -0.53571017, -0.30424204,
       -0.63310826, -0.7143538 , -0.79851225, -0.50669083, -0.05631931,
       -0.17527678, -0.4054205 , -0.58396029, -0.56898995, -0.15916537,
       -0.04244518, -0.22660433, -0.38656171, -0.49800324, -0.17207118,
        0.11080571,  0.00529862, -0.17498167, -0.31405696, -0.21484311,
       -0.00561303, -0.03334915, -0.10717843, -0.2494189 , -0.27440083,
       -0.14508858, -0.0917033 , -0.11526029, -0.17078629, -0.24440751,
       -0.23679843, -0.18958036, -0.20165806, -0.22767644, -0.31324969,
       -0.30420175, -0.29595889, -0.28426288, -0.28450613, -0.31204386,
       -0.29586717, -0.29168898, -0.29037677, -0.27569342, -0.27072704,
       -0.22833598, -0.21585719, -0.24548355, -0.24623213, -0.2409032 ,
       -0.20003462, -0.16405088, -0.19424544, -0.23909709, -0.33846622,
       -0.27947479, -0.1722877 , -0.17295043, -0.21794247, -0.298375  ,
       -0.34290255, -0.1881901 , -0.13331018, -0.16133155, -0.20022118,
       -0.30557954, -0.19760237, -0.12914763, -0.1401868 , -0.10796165,
       -0.16566489, -0.16167778, -0.08665117, -0.10360411, -0.0558402 ,
       -0.06189398, -0.07413712, -0.03714827, -0.07210221, -0.09770882,
       -0.05970264,  0.00155068,  0.03884991, -0.01403836, -0.09127006,
       -0.13410797])
sample3 =  np.array([-1.78765350e-02,  2.84700336e-02, -8.59524585e-02, -6.49824821e-02,
        9.73186324e-02,  2.80399454e-02,  6.16966441e-02,  1.26360321e-02,
       -4.16904159e-02,  1.15755129e-01,  9.39159076e-02,  4.54825299e-02,
        6.35534984e-03, -1.11934981e-01,  9.86016690e-03,  4.03411286e-02,
       -3.63240222e-02, -2.69436646e-02, -1.93340834e-01, -1.51038703e-01,
        2.33524090e-02, -4.44928058e-02,  3.66998211e-03, -5.96691846e-02,
       -1.46920491e-01,  4.64066558e-02,  3.65233876e-02,  2.89492791e-02,
       -5.66719551e-03, -1.41522207e-01, -2.17487692e-02,  4.57006999e-02,
        2.70478124e-02,  2.56728317e-02, -1.19837448e-01, -1.08322689e-01,
        2.24569959e-02,  1.82804969e-02,  1.98358590e-02, -8.76222360e-02,
       -1.92413391e-01, -4.47329617e-02,  8.30993568e-03,  2.74040027e-02,
       -2.36747991e-02, -1.62946457e-01, -1.09317084e-01, -2.87766355e-02,
       -1.41240482e-02, -6.60550980e-03, -1.61364117e-01, -1.88703792e-01,
       -6.88744307e-02, -4.24416445e-02,  8.53781200e-03, -8.17442744e-02,
       -1.50784796e-01, -9.00810201e-02, -4.58429588e-02,  1.90418655e-02,
        8.39284092e-03, -1.56831311e-01, -1.03348410e-01, -4.23768715e-02,
        3.19606672e-02,  8.86749336e-02, -1.20974071e-01, -1.44303840e-01,
       -2.00393042e-02,  7.04173936e-03,  8.13645771e-02, -9.75420138e-02,
       -3.27926209e-01, -1.50299020e-01, -7.76418293e-02,  8.77884528e-03,
       -3.81409697e-04, -3.87351363e-01, -2.90665879e-01, -9.53955491e-02,
        2.66842368e-02,  1.08092460e-01, -3.51250953e-01, -4.22963183e-01,
       -1.83901386e-01, -2.10103193e-01,  1.46007721e-01,  2.50183906e-02,
       -6.13879971e-01, -5.60652614e-01, -5.45111069e-01, -3.46918471e-01,
       -1.61949854e-01, -7.31300914e-01, -1.00720166e+00, -1.00393910e+00,
       -8.60713433e-01, -3.16149548e-01, -7.05564910e-01, -1.31043105e+00,
       -1.20316266e+00, -1.17007031e+00, -7.24727520e-01, -5.88537841e-01,
       -1.11656028e+00, -1.07545325e+00, -1.15044320e+00, -1.05076348e+00,
       -4.79705318e-01, -7.14745164e-01, -1.05337558e+00, -1.08603133e+00,
       -1.09440176e+00, -5.37258695e-01, -3.08587512e-01, -6.48541122e-01,
       -7.15057900e-01, -8.12007862e-01, -5.24207705e-01, -5.55404461e-02,
       -1.93696937e-01, -4.16844175e-01, -5.84829548e-01, -5.90787260e-01,
       -1.62184542e-01, -4.76362307e-02, -2.42519120e-01, -3.87224959e-01,
       -5.00697225e-01, -1.81972198e-01,  1.04976906e-01, -3.49879139e-03,
       -1.91284176e-01, -3.15189581e-01, -2.27381385e-01, -7.06477689e-03,
       -4.03851705e-02, -1.20307986e-01, -2.58128973e-01, -2.75160394e-01,
       -1.48343446e-01, -1.01229894e-01, -1.27128186e-01, -1.82151905e-01,
       -2.56825120e-01, -2.45329823e-01, -1.89096500e-01, -2.06171619e-01,
       -2.47704706e-01, -3.46561429e-01, -3.15636688e-01, -3.10784756e-01,
       -2.91814682e-01, -2.86323810e-01, -3.30662966e-01, -3.05337141e-01,
       -3.09176565e-01, -3.07129757e-01, -2.84626299e-01, -2.76150443e-01,
       -2.44848103e-01, -2.21262530e-01, -2.57622999e-01, -2.65440776e-01,
       -2.48425078e-01, -2.00979300e-01, -1.66375430e-01, -1.94102725e-01,
       -2.55372768e-01, -3.66254285e-01, -2.88028511e-01, -1.73972655e-01,
       -1.76722798e-01, -2.25145299e-01, -3.22056618e-01, -3.51256123e-01,
       -1.80992124e-01, -1.30431127e-01, -1.56691515e-01, -2.13603189e-01,
       -3.26939757e-01, -1.88821018e-01, -1.27471137e-01, -1.39656792e-01,
       -1.15845733e-01, -1.80022199e-01, -1.62801725e-01, -8.84982574e-02,
       -1.13094378e-01, -5.79258610e-02, -6.78860308e-02, -9.63449536e-02,
       -1.62284036e-02, -7.86799399e-02, -1.12278897e-01, -6.39958824e-02,
       -9.59147308e-03,  4.50563131e-02, -5.37334580e-03, -9.76225349e-02,
       -1.41526153e-01])
sample4 = np.array([-1.77966673e-02,  3.29479244e-02, -8.59453244e-02, -6.79701015e-02,
        9.50399637e-02,  2.67781844e-02,  6.03384457e-02,  1.65697030e-02,
       -4.16984479e-02,  1.20832882e-01,  9.73344128e-02,  4.25485228e-02,
        6.42948219e-03, -1.10172512e-01,  1.29066672e-02,  4.02103861e-02,
       -3.83974773e-02, -2.67907525e-02, -1.91891626e-01, -1.49130085e-01,
        2.40673447e-02, -4.07493922e-02,  7.81843952e-03, -5.78228673e-02,
       -1.48908820e-01,  4.30642761e-02,  3.43297285e-02,  2.85991664e-02,
       -9.27991546e-03, -1.41760009e-01, -1.64233140e-02,  4.74243786e-02,
        2.80345798e-02,  2.55367630e-02, -1.17475831e-01, -1.05973409e-01,
        2.18683902e-02,  1.02888015e-02,  2.20149946e-02, -8.92069208e-02,
       -1.90343564e-01, -4.36367837e-02,  1.26730427e-02,  2.88625756e-02,
       -1.89451198e-02, -1.64040341e-01, -1.08162724e-01, -2.75886875e-02,
       -1.21025667e-02, -5.01669364e-03, -1.57850486e-01, -1.91102888e-01,
       -6.73793595e-02, -4.04064895e-02,  8.81963140e-03, -7.58211828e-02,
       -1.56834470e-01, -9.05973949e-02, -4.54413664e-02,  1.79199749e-02,
        8.84365780e-03, -1.53120771e-01, -1.04302864e-01, -4.11339076e-02,
        4.01749978e-02,  9.09276991e-02, -1.19119890e-01, -1.41074224e-01,
       -1.72268153e-02,  3.12696001e-03,  8.32671901e-02, -1.01802269e-01,
       -3.25872184e-01, -1.48405758e-01, -7.29021884e-02,  1.28109453e-02,
        4.31945634e-04, -3.87025682e-01, -2.86082245e-01, -9.68596334e-02,
        2.47915278e-02,  1.07974524e-01, -3.46543342e-01, -4.21973381e-01,
       -1.84349522e-01, -2.08453583e-01,  1.50082668e-01,  2.67130196e-02,
       -6.12225899e-01, -5.64137816e-01, -5.46364345e-01, -3.46807181e-01,
       -1.60146320e-01, -7.27523031e-01, -1.00398389e+00, -1.00589497e+00,
       -8.58669948e-01, -3.15479492e-01, -7.06800434e-01, -1.30637148e+00,
       -1.20248303e+00, -1.17226984e+00, -7.24652473e-01, -5.83440595e-01,
       -1.11293191e+00, -1.07634542e+00, -1.15130712e+00, -1.04945420e+00,
       -4.78477220e-01, -7.12610771e-01, -1.04869336e+00, -1.08311289e+00,
       -1.08876908e+00, -5.39333933e-01, -3.04361342e-01, -6.43953301e-01,
       -7.15613196e-01, -8.18950131e-01, -5.25092863e-01, -5.79464904e-02,
       -1.87251033e-01, -4.07190821e-01, -5.79238823e-01, -5.83386481e-01,
       -1.62336121e-01, -4.41810821e-02, -2.40161540e-01, -3.84608553e-01,
       -4.99400809e-01, -1.88177383e-01,  1.10248437e-01, -1.74276530e-03,
       -1.89515052e-01, -3.12663778e-01, -2.24677573e-01, -9.05941439e-03,
       -3.81520954e-02, -1.24158481e-01, -2.64969128e-01, -2.80845099e-01,
       -1.40382966e-01, -9.92949178e-02, -1.28012697e-01, -1.81974095e-01,
       -2.59723260e-01, -2.38862425e-01, -1.95703489e-01, -2.08306424e-01,
       -2.41398109e-01, -3.44994391e-01, -3.07704431e-01, -3.08397435e-01,
       -2.89880162e-01, -2.86738374e-01, -3.27678527e-01, -3.07995408e-01,
       -3.11440904e-01, -3.05187210e-01, -2.87189305e-01, -2.79546604e-01,
       -2.42666308e-01, -2.22149141e-01, -2.55074090e-01, -2.63546244e-01,
       -2.43676910e-01, -1.98793386e-01, -1.64520810e-01, -1.91546303e-01,
       -2.46223623e-01, -3.63713112e-01, -2.80408955e-01, -1.67808019e-01,
       -1.67760392e-01, -2.23946146e-01, -3.16959313e-01, -3.53238112e-01,
       -1.84432384e-01, -1.30684385e-01, -1.57209871e-01, -2.11176914e-01,
       -3.26423105e-01, -1.89213469e-01, -1.28742553e-01, -1.29742002e-01,
       -1.09559897e-01, -1.80298923e-01, -1.59503624e-01, -8.50671182e-02,
       -1.15288014e-01, -5.98180728e-02, -6.30390269e-02, -8.63073568e-02,
       -1.40369848e-02, -7.27343044e-02, -1.10923381e-01, -5.82270164e-02,
       -5.53291676e-03,  4.35775689e-02, -4.44135898e-03, -9.90905373e-02,
       -1.35989206e-01])

plt.figure(1458)
test = []
for i,j,k,m in zip(sample1, sample2, sample3, sample4):
    f = (i+j+k+m)/4
    test.append(f)
#print(test)
plt.title('S12 Log Mag Average')
plt.xlabel('frequency (Hz)')
plt.ylabel('Log Magnitude (dB)')
plt.plot(x, test)
#print(test)
#print(test)
S22avg = []
for i in range(N):
    if i == 0:
        continue
    if i == 1:
        continue
    if i ==2:
        continue
    if i == 4:
        continue
    if i == 5:
        continue
    if i == 6:
        continue
    if i == 8:
        continue
    if i == 9:
        continue
    if i == 10:
        continue
    if i == 12:
        continue
    if i == 13:
        continue
    if i == 14:
        continue
    if i == 15:
        continue
    if i == 16:
        continue
    if i == 17:
        continue
    if i == 18:
        continue
    
    
    fig = plt.figure(4)
#    print(i, ':', keyslist[i])
    y = datalist[i]             # data 
#    print(y)
#    test = i*conj(i)
    f = np.abs(y)
#    f = sqrt(test)
    mag = 20*log10(f)
#    print(mag)
    S22avg.append(mag)
#    [S11, S21, S12,S22]
#    y = np.append(mag)
    plt.xlabel('Frequancy (Hz)')
    plt.ylabel('Log Magnitude (dB)')
#    plt.plot(x, mag)
    plt.title(name_dict[i])
    if i == 3:
        plt.plot(x, mag, label = 'Sample1')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 7:
        plt.plot(x, mag, label = 'Sample2')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 11:
        plt.plot(x, mag, label = 'Sample3')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
#    if i == 15:
#        plt.plot(x, mag, label = 'Sample4')
#        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
    if i == 19:
        plt.plot(x, mag, label = 'Sample5')
        plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))
#plt.show()
#print(S22avg)

sample1 = np.array([-24.58977866, -24.14273504, -23.98287299, -23.32316587,
       -22.07752873, -22.01537922, -22.14946521, -22.90713413,
       -23.34918073, -22.44228255, -21.62321225, -21.14154685,
       -21.07264289, -21.36649471, -21.10284139, -20.47131245,
       -19.85336756, -19.30344125, -19.31431318, -19.20554915,
       -18.83069454, -18.51093109, -18.26717092, -18.2038228 ,
       -18.40567586, -18.96110912, -19.36807265, -19.9242681 ,
       -20.35390971, -21.24876523, -22.42860244, -22.9159454 ,
       -23.1555131 , -23.120831  , -23.13375189, -23.8617419 ,
       -24.8283377 , -25.27273397, -25.19425198, -23.93004787,
       -23.65319937, -24.24044317, -24.22988287, -24.80265169,
       -24.1642835 , -23.63226724, -22.82023247, -21.32462901,
       -20.56056851, -19.77451701, -19.48795887, -19.75445157,
       -18.98986021, -18.38651994, -18.08889288, -17.80162431,
       -18.19466529, -18.13734597, -17.5479247 , -17.29918611,
       -16.50862515, -16.31264685, -16.36832286, -15.78436466,
       -15.63612647, -15.61828   , -15.79389581, -16.66314166,
       -16.6239734 , -16.17570465, -15.91271489, -15.21351331,
       -15.23303631, -15.39842813, -14.89460191, -14.4247779 ,
       -13.77295437, -13.59767029, -14.17182507, -14.35827553,
       -14.39447108, -14.21263454, -13.99897929, -13.98911786,
       -13.68158439, -13.44102026, -13.3826446 , -13.20189966,
       -12.87076351, -12.90387092, -12.56950306, -12.65247143,
       -12.61131391, -12.43646711, -12.25395579, -11.66819689,
       -11.37661858, -11.15645559, -10.48728353, -10.1695302 ,
       -10.16009037, -10.1531437 , -10.41889096, -10.11994593,
       -10.11489519, -10.17340481,  -9.83619   ,  -9.77712066,
        -9.74638174,  -9.55670525,  -9.41195635,  -9.1120973 ,
        -9.04701356,  -9.20524708,  -9.08906858,  -9.46614141,
        -9.2927868 ,  -9.27073185,  -9.29984376,  -9.30481835,
        -9.16890179,  -9.10726053,  -9.03956183,  -9.29546957,
        -9.47599077,  -9.35797117,  -9.28242198,  -9.41965585,
        -9.82386479, -10.43358188, -10.80491744, -10.68093831,
       -10.80135242, -10.96512975, -11.56953202, -12.04197456,
       -12.25915926, -12.8380311 , -13.47836576, -14.41530328,
       -15.68349331, -16.90115069, -18.31466814, -19.64305497,
       -20.45360976, -22.24793822, -23.64472293, -25.26162674,
       -27.95120536, -29.74048322, -37.87595305, -38.05988653,
       -29.94683812, -25.20343263, -23.76628092, -22.93212977,
       -21.01414665, -20.17218258, -19.19495206, -18.5125423 ,
       -18.59734205, -17.97541245, -17.21503198, -16.58990104,
       -15.28114102, -14.79431016, -14.23221555, -13.36462652,
       -13.25189265, -13.13074499, -13.2415442 , -13.59696206,
       -13.39293012, -13.29876715, -13.35048759, -13.49836988,
       -13.89720128, -13.73167378, -13.1776925 , -13.18530782,
       -13.29720678, -13.89877194, -14.27894922, -14.17871584,
       -14.36429185, -14.29725049, -15.24720318, -16.4753908 ,
       -16.31695777, -15.88209424, -15.13709716, -14.58794443,
       -15.39402132, -16.0193927 , -16.0801778 , -15.64666536,
       -14.28161386, -14.80359693, -16.53542305, -18.02995677,
       -18.46172019])
sample2 = np.array([-24.64870386, -24.02829082, -23.94169696, -23.30196834,
       -21.99479937, -22.05658353, -22.12754756, -22.82917412,
       -23.35128276, -22.41821501, -21.64803851, -21.17930266,
       -21.04192322, -21.36035371, -21.11828155, -20.45381202,
       -19.9034161 , -19.32466158, -19.29894306, -19.16727801,
       -18.81918461, -18.50069262, -18.28647917, -18.18765428,
       -18.39597594, -18.95292286, -19.35615105, -19.95891228,
       -20.39858141, -21.2819282 , -22.48927216, -22.91476015,
       -23.16291   , -23.14962542, -23.17795085, -23.91176499,
       -24.76888211, -25.2195444 , -25.23558797, -24.02245038,
       -23.73329338, -24.19595601, -24.24977489, -24.79720068,
       -24.19851599, -23.69978443, -22.76175922, -21.32976468,
       -20.61047299, -19.82026216, -19.50565376, -19.69059213,
       -18.97865959, -18.37723761, -18.11351527, -17.83326556,
       -18.166697  , -18.06868621, -17.54442587, -17.30469299,
       -16.54639519, -16.33143849, -16.29245262, -15.75195734,
       -15.60482945, -15.65794267, -15.86046861, -16.63531814,
       -16.58715147, -16.16190977, -15.9056319 , -15.28304166,
       -15.25839392, -15.33604391, -14.8718294 , -14.39948826,
       -13.80043675, -13.64043985, -14.14633233, -14.32374635,
       -14.35253524, -14.21684153, -14.06265795, -13.99984186,
       -13.66441536, -13.42031818, -13.33950553, -13.23308007,
       -12.92225985, -12.90654799, -12.5768479 , -12.62492417,
       -12.61730913, -12.50280533, -12.3179352 , -11.70331136,
       -11.35536896, -11.13251887, -10.52965419, -10.22467717,
       -10.19039048, -10.16322152, -10.38599531, -10.12330848,
       -10.15546974, -10.19479522,  -9.86040741,  -9.74833053,
        -9.71952147,  -9.57498698,  -9.4314596 ,  -9.14147974,
        -9.03809631,  -9.15503693,  -9.06960982,  -9.17616571,
        -9.30659848,  -9.28260786,  -9.27133144,  -9.25803035,
        -9.16219148,  -9.12222655,  -9.07983666,  -9.28453541,
        -9.43998989,  -9.3348929 ,  -9.27561326,  -9.43881216,
        -9.84726198, -10.36649867, -10.7251233 , -10.660513  ,
       -10.8090688 , -11.00217022, -11.52907882, -11.97470738,
       -12.23088326, -12.81357516, -13.5279996 , -14.42524389,
       -15.58275671, -16.7737007 , -18.19191378, -19.6201073 ,
       -20.54395794, -22.16137754, -23.47981081, -24.98172713,
       -27.66448736, -30.11989437, -39.4393011 , -39.12909484,
       -30.27609455, -25.60175932, -23.78978625, -22.66980627,
       -21.01224345, -20.15097296, -19.19686022, -18.51273351,
       -18.47899591, -17.96817028, -17.23019796, -16.56970366,
       -15.39117251, -14.79644658, -14.18006136, -13.38745919,
       -13.21505201, -13.17790547, -13.29744497, -13.51717339,
       -13.38720262, -13.31204629, -13.42011372, -13.6271513 ,
       -13.85743834, -13.66579437, -13.19399979, -13.25414898,
       -13.42198805, -13.87680694, -14.14479637, -14.13139191,
       -14.37132683, -14.47815645, -15.38479572, -16.34037935,
       -16.24452348, -15.79628012, -15.23714273, -14.86842335,
       -15.46113372, -15.91778904, -15.92403228, -15.54667161,
       -14.60317396, -15.05671135, -16.49179197, -17.74583653,
       -18.03669192])
sample3 =  np.array([-24.59122132, -24.13247419, -24.0053436 , -23.38074933,
       -22.06722683, -22.00456306, -22.14139184, -22.88128219,
       -23.33551208, -22.42529676, -21.61716022, -21.13878751,
       -21.04488712, -21.3583865 , -21.08821101, -20.47280973,
       -19.8723788 , -19.30466316, -19.29675275, -19.2052408 ,
       -18.85126859, -18.51346823, -18.29288391, -18.19043778,
       -18.40212675, -18.95903905, -19.35597252, -19.93968128,
       -20.34916544, -21.22680398, -22.42706676, -22.89094046,
       -23.16609922, -23.1154761 , -23.11870402, -23.81466802,
       -24.81795163, -25.26463905, -25.20232292, -23.93158629,
       -23.65589782, -24.24590237, -24.26634557, -24.78558772,
       -24.13766524, -23.65352097, -22.8411619 , -21.31406568,
       -20.5341624 , -19.73770072, -19.47038393, -19.7721659 ,
       -19.01488832, -18.38646758, -18.10445993, -17.77366829,
       -18.17622992, -18.15510136, -17.5594852 , -17.30624131,
       -16.48943269, -16.31987077, -16.3696439 , -15.80026859,
       -15.65774857, -15.62078887, -15.78595195, -16.67115874,
       -16.6174557 , -16.1726713 , -15.90799442, -15.18697754,
       -15.20018776, -15.41230502, -14.90403072, -14.42181653,
       -13.76873173, -13.59262228, -14.17532166, -14.35942532,
       -14.4003741 , -14.2089518 , -13.99998046, -13.98055013,
       -13.67940711, -13.43193249, -13.4022004 , -13.20113372,
       -12.84774963, -12.88578961, -12.56335256, -12.64654051,
       -12.59903834, -12.42441147, -12.24807599, -11.6483188 ,
       -11.36685029, -11.14730712, -10.46736671, -10.16346421,
       -10.15841816, -10.1552586 , -10.42450819, -10.11443998,
       -10.10589786, -10.17176993,  -9.82618246,  -9.765127  ,
        -9.74347729,  -9.54286184,  -9.39353653,  -9.1036676 ,
        -9.03660357,  -9.21462692,  -9.09316075,  -9.16687323,
        -9.28765046,  -9.26061745,  -9.31042268,  -9.30786708,
        -9.17083942,  -9.10230097,  -9.03583205,  -9.29644504,
        -9.50629547,  -9.36748541,  -9.28140707,  -9.4183457 ,
        -9.8274651 , -10.44037781, -10.82055107, -10.68478194,
       -10.79630852, -10.95227783, -11.55857722, -12.04597395,
       -12.25176743, -12.83831192, -13.48205111, -14.41684313,
       -15.70178061, -16.90413233, -18.33643604, -19.62062727,
       -20.45163246, -22.2326702 , -23.60890403, -25.27127566,
       -28.01549201, -29.63690082, -37.40330649, -38.30530384,
       -30.01944782, -25.24580678, -23.81724148, -23.05279094,
       -21.04008986, -20.17191733, -19.22080687, -18.47702604,
       -18.63596536, -17.9754158 , -17.21572458, -16.59093603,
       -15.26129711, -14.77187384, -14.23543295, -13.36627816,
       -13.26017916, -13.1267387 , -13.24386464, -13.60827474,
       -13.39633386, -13.29328204, -13.33945673, -13.47156026,
       -13.88806677, -13.74024314, -13.14676256, -13.14823219,
       -13.25265641, -13.8828127 , -14.27444597, -14.16244077,
       -14.34361271, -14.2271081 , -15.22583287, -16.46783577,
       -16.29572491, -15.87230172, -15.12757609, -14.53545222,
       -15.36551081, -16.0055877 , -16.11443432, -15.65445541,
       -14.27187283, -14.76427388, -16.53571486, -18.08231359,
       -18.49184991])
sample4 =  np.array([-24.57626877, -24.1423166 , -24.01324611, -23.35618875,
       -22.09744059, -22.02676413, -22.13493758, -22.90487901,
       -23.34302468, -22.43255627, -21.61830338, -21.1292669 ,
       -21.06322738, -21.35925203, -21.08452431, -20.45579028,
       -19.8472492 , -19.31624857, -19.32739152, -19.18954774,
       -18.85426192, -18.51421846, -18.27739671, -18.18183361,
       -18.40626002, -18.96537388, -19.37629989, -19.93806337,
       -20.33776104, -21.25234069, -22.44100373, -22.92109056,
       -23.1174442 , -23.10011756, -23.1076378 , -23.83168589,
       -24.80292825, -25.25064088, -25.1708319 , -23.89290973,
       -23.69099125, -24.21329167, -24.25741568, -24.78934236,
       -24.11884624, -23.6451618 , -22.84014071, -21.31755742,
       -20.5496069 , -19.72677629, -19.46938612, -19.78047152,
       -19.01938835, -18.39077302, -18.09481131, -17.80459998,
       -18.19999295, -18.17069096, -17.56594109, -17.31524938,
       -16.49347048, -16.309392  , -16.36858065, -15.79657605,
       -15.64910201, -15.61821418, -15.76969385, -16.66495384,
       -16.63339846, -16.17741912, -15.9139802 , -15.21497467,
       -15.21166157, -15.39036926, -14.90330135, -14.42473474,
       -13.77539794, -13.58460227, -14.17744119, -14.3555981 ,
       -14.40312748, -14.2038311 , -13.98785929, -13.97988182,
       -13.67779022, -13.43362277, -13.39636976, -13.18569106,
       -12.85557055, -12.88411149, -12.56368084, -12.6456095 ,
       -12.60289665, -12.41812552, -12.24300794, -11.65238419,
       -11.36853887, -11.13865446, -10.46581008, -10.15951241,
       -10.1496632 , -10.15236169, -10.42189652, -10.11379292,
       -10.10391055, -10.16673019,  -9.82418693,  -9.75725975,
        -9.74601903,  -9.54632547,  -9.4080232 ,  -9.11269923,
        -9.04827822,  -9.21051408,  -9.09278494,  -9.17164128,
        -9.28658048,  -9.2620951 ,  -9.3074696 ,  -9.31175594,
        -9.16520612,  -9.1022171 ,  -9.03564619,  -9.29983916,
        -9.50891346,  -9.36852927,  -9.28486651,  -9.40688915,
        -9.82689008, -10.45381587, -10.82922935, -10.68049644,
       -10.7972659 , -10.96113751, -11.5539608 , -12.05800697,
       -12.25825359, -12.84526932, -13.47558524, -14.41052351,
       -15.69160484, -16.89206967, -18.31760839, -19.66286455,
       -20.42275976, -22.23175616, -23.6559045 , -25.20778652,
       -27.9819754 , -29.59673914, -37.51124986, -38.32032894,
       -29.95805599, -25.23104232, -23.82248972, -23.07439393,
       -21.04278597, -20.17412565, -19.20608646, -18.50219067,
       -18.64406177, -17.99467025, -17.21080708, -16.59833814,
       -15.26399843, -14.77972365, -14.2424421 , -13.36134608,
       -13.25293294, -13.1209908 , -13.24845585, -13.59604726,
       -13.38278608, -13.29780947, -13.3353895 , -13.47276377,
       -13.89601442, -13.73536059, -13.15594308, -13.16453422,
       -13.25387296, -13.87379687, -14.27625796, -14.16033823,
       -14.34156097, -14.21954098, -15.21760876, -16.47979195,
       -16.29959574, -15.86984971, -15.12542209, -14.5371268 ,
       -15.35698566, -16.01776252, -16.09848879, -15.65103367,
       -14.25854034, -14.75234519, -16.54494518, -18.06886855,
       -18.50388177])
plt.figure(1460)
test = []
for i,j,k,m in zip(sample1, sample2, sample3, sample4):
    f = (i+j+k+m)/4
    test.append(f)
#print(test)
plt.title('S22 Log Mag Average')
plt.xlabel('frequency (Hz)')
plt.ylabel('Log Magnitude (dB)')
plt.plot(x, test)
print(test)

        
S1 = []      
'----------------------------------------------'
for i in range(N):
    if i == 1:
        continue
    if i == 2:
        continue
    if i ==3:
        continue
    if i == 5:
        continue
    if i == 6:
        continue
    if i == 7:
        continue
    if i == 9:
        continue
    if i == 10:
        continue
    if i == 11:
        continue
    if i == 13:
        continue
    if i == 14:
        continue
    if i == 15:
        continue
    if i == 17:
        continue
    if i == 18:
        continue
    if i == 19:
        continue
       
#    fig = plt.figure(100)
#    print(i, ':', keyslist[i])
    y = datalist[i]             # data 
#    print(y)
    f = np.abs(y)
#    f = sqrt(test)
#    t.append(f)
#    w.append(f)
    mag = 20*log10(f)
    S11 = 10**mag
#    print(S11, 'S11')
    S1.append(S11)
fig = plt.figure(901)
plt.title('Sheilding Effectivness Due To Absorption')
plt.xlabel('Frequency (Hz)')
plt.ylabel('Shielding Due To Absorption (dB)')
SEA1 = -10 * log10(np.abs(S2[0])**2 / (1 - np.abs(S1[0])**2))
plt.plot(x, SEA1, label = 'Sample1')
plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))


SEA2 = -10 * log10(np.abs(S2[1])**2 / (1 - np.abs(S1[1])**2))
plt.plot(x, SEA2, label = 'Sample2')
plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))


SEA3 = -10 * log10(np.abs(S2[2])**2 / (1 - np.abs(S1[2])**2))
plt.plot(x, SEA3, label = 'Sample3')
plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))

SEA4 = -10 * log10(np.abs(S2[3])**2 / (1 - np.abs(S1[3])**2))
plt.plot(x, SEA4, label = 'Sample4')
plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))

#SEA5 = -10 * log10(np.abs(S2[4])**2 / (1 - np.abs(S1[4])**2))
#plt.plot(x, SEA5, label = 'Sample5')
#plt.legend(loc='center left', bbox_to_anchor=(1, 0.5))

        

plt.show()



